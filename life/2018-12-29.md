# 工作产生极度戾气

![image-20181231144057644](https://ws3.sinaimg.cn/large/006tNbRwly1fypx8h8ty1j30qa0q67p9.jpg)

题图：[createcommune](https://www.instagram.com/createcommune/) from instagram 

12.29是2018的最后一个工作日，昨天今天部门好多人请假了，说明什么？至少人家很闲。但我呢？在放假前夕我忙的焦头烂额。组件本来只有三个人，一个主力请了两天假，基本别人有问题都报给了我。

12.28领导拉我进群说有个天气小程序有问题让我看下，刚进群对面一个银度（工作5年+）的pm @我：“辛苦今天给下结论”。我回：“好的，今天给结论”。其实我内心：靠，你们自己这个问题三天都解决不了吧，到我这就让我半天给结论？说下两个问题：

>1. 快速滑动上下会有白色背景闪动
>2. webview组件第一次进入页面不正常、第二次及之后正常

要到了对方的小程序源码，28号下午、晚上我开始排查问题1。

1. 首先发现默认内核（百度T7内核，是在android原生内核上进行了封装，比如限制了内存使用、去掉了一些动画效果）会闪动，禁用内核使用原生内核就没问题。
2. 定位到了是默认内核环境下有问题。但我不能直接把问题丢给内核，直接说：“内核同学，你们造成了白色背景闪动，你们排查”吧，内核不是前端同学，他们肯定也解决不了。然后我继续找到底是啥导致内核环境下闪动。就用“二分法”删他们的代码，看到底是哪里的代码导致的，最后发现是因为用了rotate。
3. 好，把问题抛给内核：“小程序使用了rotate会导致快速滑动页面时候闪动白色背景，默认内核有问题，禁用内核没问题”，后来内核给的结论是“可能是默认内核限制了内存的使用，比如长列表快速滑动肯定会有白屏、闪动问题，因为浏览器反应不过来。”，他们放开内核内存限制再试试。

好了，问题1基本解决了。问题2开始：

1. 首先我观察现象：第一次进webview加载很慢，需要5s，第二次及之后只需要2s，打开webview h5的控制台一看，报错了，是一个js发送jsonp获取天气数据超时3s。好，现象基本明确：第一次加载很慢，导致获取数据的jsonp超时，导致页面展示不正常，第二次加载快，数据获取正常页面也正常
2. 把上述现象报给android rd让他们排查为什么第一次很慢。我自己则继续测试其它情况：比如发送jsonp的js在最前面，此js后面还有6个js，猜测会不是后面js的加载阻塞住了？于是把发送jsonp的js挪到最下面，果然没有问题了。因此结论进一步明确：第一次加载js阻塞了线程导致jsonp超时。继续反馈给android排查呗。

12.29号上午天气说自己开发的小程序有性能问题，又在群里@我，让我帮忙review代码。我看了下，首页启动5s+，在一些生命周期和组件渲染中打点发现，三个地方耗时多：1. 获取位置的api；2. 他们自己获取数据的接口；3. 小程序组件的渲染。他们自己的代码逻辑：

```js
swan.getLocation({
    success: function() {
        swan.request('天气数据', () => {
           // 设置数据，渲染页面 
        });
    }
});
```

竟然两个异步接口串行放一起。好问题明确了：1是android问题、3是小程序框架问题，2以及代码逻辑需要他们自己调整。我把问题反馈给各负责人。

29号下午，有个元旦运营活动的页面说是样式在某些ios机型错乱。他们搜了微信的社区，已经知道了是flex的问题。但tm跟我组件有什么关系啊，一番排查我发现父元素用来flex，子元素用了absolute，我也是服了，我真不知这俩属性结合起来用会产生什么后果。google搜：ios flex absoute 可以看到这是个已知bug。反馈给他们改样式呗。

28、29这两天还不断有小v机器人的问题、其它对接同学报过来的外部小程序的问题，元旦活动webview使用问题。不紧急的我都推迟了，回复：“下周看，先记录下icafe”。

这就是我2018年最后两个工作日的日常，以前我骂用户傻逼，现在我骂大部分的开发者都是傻逼！遇到问题不会自己先定位，特别是内部小程序，因为有依赖了，一有问题直接拉群@我们和leader。我一天有多少时间，目前已经上线小程序有好几千个，每一个遇到问题都需要我去挨个看你们小程序业务代码？

所以你看我现在的工作是什么？是解决别人在开发小程序时候遇到的各种傻逼问题，我充其量是个解决小程序开发的客服！我需要写篇文章发泄下了。

另：总结自己的工作经验：让别人帮忙看问题或者报bug，需要说明详细的复现环境，操作步骤是什么，最好提供一个复现问题的最简demo。把问题说清楚，不要让别人第一眼看不懂，还要向审判犯人一样一步步追问，说真的，我鄙视这种人。一旦遇到这种人，我都没有给他解决问题的热情了。

reference：

[coolshell: 你会问问题吗？](https://coolshell.cn/articles/3713.html)
[github: 提问的智慧](https://github.com/ryanhanwu/How-To-Ask-Questions-The-Smart-Way/blob/master/README-zh_CN.md)

